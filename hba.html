<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(15, 40px);
            grid-template-rows: repeat(15, 40px);
            gap: 2px;
            background: #333;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .cell {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            font-size: 8px;
            font-weight: bold;
        }

        .home-base {
            grid-column: span 6;
            grid-row: span 6;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .home-base.red { background: #ff4757; }
        .home-base.green { background: #2ed573; }
        .home-base.yellow { background: #ffa502; }
        .home-base.blue { background: #1e90ff; }

        .home-base-inner {
            width: 70%;
            height: 70%;
            background: white;
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 5px;
            padding: 10px;
        }

        .token-spot {
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .center-home {
            grid-column: 7 / span 3;
            grid-row: 7 / span 3;
            background: linear-gradient(45deg, #ff4757, #2ed573, #ffa502, #1e90ff);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .safe-zone {
            background: #a8e6cf !important;
        }

        .safe-zone::after {
            content: 'â˜…';
            position: absolute;
            font-size: 16px;
            color: #333;
        }

        .path-red { background: #ffcccc !important; }
        .path-green { background: #ccffcc !important; }
        .path-yellow { background: #fff5cc !important; }
        .path-blue { background: #ccccff !important; }

        .token {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            z-index: 10;
            position: absolute;
        }

        .token:hover {
            transform: scale(1.2);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        .token.red { background: #ff4757; }
        .token.green { background: #2ed573; }
        .token.yellow { background: #ffa502; }
        .token.blue { background: #1e90ff; }

        .token.movable {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .player-info.active {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }

        .player-color {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 3px solid white;
        }

        .dice-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .dice {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.3s;
        }

        .dice:hover {
            transform: rotate(10deg);
        }

        .dice.rolling {
            animation: roll 0.5s ease-in-out;
        }

        @keyframes roll {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(90deg); }
            50% { transform: rotate(180deg); }
            75% { transform: rotate(270deg); }
            100% { transform: rotate(360deg); }
        }

        .roll-btn {
            padding: 10px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .roll-btn:hover {
            background: #5568d3;
        }

        .roll-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .message {
            text-align: center;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 18px;
            color: #333;
        }

        .winner-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .winner-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        .winner-content h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .restart-btn {
            padding: 15px 40px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .restart-btn:hover {
            background: #5568d3;
        }

        .tokens-in-cell {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            justify-content: center;
            align-items: center;
        }

        .token.small {
            width: 20px;
            height: 20px;
            border-width: 2px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ðŸŽ² Ludo Game ðŸŽ²</h1>
        
        <div class="message" id="message">Red's turn! Roll the dice to start.</div>
        
        <div class="controls">
            <div class="player-info" id="player-red">
                <div class="player-color" style="background: #ff4757;"></div>
                <span>Red</span>
            </div>
            <div class="player-info" id="player-green">
                <div class="player-color" style="background: #2ed573;"></div>
                <span>Green</span>
            </div>
            <div class="dice-container">
                <div class="dice" id="dice">ðŸŽ²</div>
                <button class="roll-btn" id="rollBtn">Roll Dice</button>
            </div>
            <div class="player-info" id="player-yellow">
                <div class="player-color" style="background: #ffa502;"></div>
                <span>Yellow</span>
            </div>
            <div class="player-info" id="player-blue">
                <div class="player-color" style="background: #1e90ff;"></div>
                <span>Blue</span>
            </div>
        </div>

        <div class="board" id="board"></div>
    </div>

    <div class="winner-modal" id="winnerModal">
        <div class="winner-content">
            <h2 id="winnerText">ðŸŽ‰ Red Wins! ðŸŽ‰</h2>
            <button class="restart-btn" onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        // Game Constants
        const PLAYERS = ['red', 'green', 'yellow', 'blue'];
        const SAFE_ZONES = [0, 8, 13, 21, 26, 34, 39, 47];
        const HOME_ENTRY = { red: 50, green: 38, yellow: 24, blue: 12 };
        const HOME_STRETCH_START = { red: 51, green: 39, yellow: 25, blue: 13 };
        
        // Path coordinates for the main track (52 cells)
        const MAIN_PATH = [
            {row: 6, col: 1}, {row: 6, col: 2}, {row: 6, col: 3}, {row: 6, col: 4}, {row: 6, col: 5},
            {row: 5, col: 6}, {row: 4, col: 6}, {row: 3, col: 6}, {row: 2, col: 6}, {row: 1, col: 6},
            {row: 0, col: 6}, {row: 0, col: 7}, {row: 0, col: 8},
            {row: 1, col: 8}, {row: 2, col: 8}, {row: 3, col: 8}, {row: 4, col: 8}, {row: 5, col: 8},
            {row: 6, col: 9}, {row: 6, col: 10}, {row: 6, col: 11}, {row: 6, col: 12}, {row: 6, col: 13},
            {row: 6, col: 14}, {row: 7, col: 14}, {row: 8, col: 14},
            {row: 8, col: 13}, {row: 8, col: 12}, {row: 8, col: 11}, {row: 8, col: 10}, {row: 8, col: 9},
            {row: 9, col: 8}, {row: 10, col: 8}, {row: 11, col: 8}, {row: 12, col: 8}, {row: 13, col: 8},
            {row: 14, col: 8}, {row: 14, col: 7}, {row: 14, col: 6},
            {row: 13, col: 6}, {row: 12, col: 6}, {row: 11, col: 6}, {row: 10, col: 6}, {row: 9, col: 6},
            {row: 8, col: 5}, {row: 8, col: 4}, {row: 8, col: 3}, {row: 8, col: 2}, {row: 8, col: 1},
            {row: 8, col: 0}, {row: 7, col: 0}, {row: 6, col: 0}
        ];

        // Home stretch paths for each player
        const HOME_PATHS = {
            red: [{row: 7, col: 1}, {row: 7, col: 2}, {row: 7, col: 3}, {row: 7, col: 4}, {row: 7, col: 5}, {row: 7, col: 6}],
            green: [{row: 1, col: 7}, {row: 2, col: 7}, {row: 3, col: 7}, {row: 4, col: 7}, {row: 5, col: 7}, {row: 6, col: 7}],
            yellow: [{row: 7, col: 13}, {row: 7, col: 12}, {row: 7, col: 11}, {row: 7, col: 10}, {row: 7, col: 9}, {row: 7, col: 8}],
            blue: [{row: 13, col: 7}, {row: 12, col: 7}, {row: 11, col: 7}, {row: 10, col: 7}, {row: 9, col: 7}, {row: 8, col: 7}]
        };

        // Starting positions for each player's tokens on the main path
        const START_POSITIONS = {
            red: 0,
            green: 13,
            yellow: 26,
            blue: 39
        };

        // Game State
        let currentPlayer = 0;
        let diceValue = 0;
        let hasRolled = false;
        let tokens = {};
        let consecutiveSixes = 0;

        // Initialize game
        function initGame() {
            createBoard();
            initializeTokens();
            updatePlayerInfo();
        }

        // Create the game board
        function createBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';

            // Create home bases
            const homeBases = [
                {class: 'red', row: 1, col: 1},
                {class: 'green', row: 1, col: 10},
                {class: 'yellow', row: 10, col: 10},
                {class: 'blue', row: 10, col: 1}
            ];

            homeBases.forEach(base => {
                const homeBase = document.createElement('div');
                homeBase.className = `home-base ${base.class}`;
                homeBase.style.gridRow = `${base.row} / span 6`;
                homeBase.style.gridColumn = `${base.col} / span 6`;
                
                const inner = document.createElement('div');
                inner.className = 'home-base-inner';
                
                for (let i = 0; i < 4; i++) {
                    const spot = document.createElement('div');
                    spot.className = 'token-spot';
                    spot.dataset.homeSpot = `${base.class}-${i}`;
                    inner.appendChild(spot);
                }
                
                homeBase.appendChild(inner);
                board.appendChild(homeBase);
            });

            // Create center home
            const centerHome = document.createElement('div');
            centerHome.className = 'center-home';
            centerHome.textContent = 'ðŸ  HOME';
            board.appendChild(centerHome);

            // Create main path cells
            MAIN_PATH.forEach((pos, index) => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.style.gridRow = pos.row + 1;
                cell.style.gridColumn = pos.col + 1;
                cell.dataset.pathIndex = index;
                
                // Mark safe zones
                if (SAFE_ZONES.includes(index)) {
                    cell.classList.add('safe-zone');
                }
                
                // Mark starting positions
                if (index === START_POSITIONS.red) cell.classList.add('path-red');
                if (index === START_POSITIONS.green) cell.classList.add('path-green');
                if (index === START_POSITIONS.yellow) cell.classList.add('path-yellow');
                if (index === START_POSITIONS.blue) cell.classList.add('path-blue');
                
                board.appendChild(cell);
            });

            // Create home stretch cells
            Object.keys(HOME_PATHS).forEach(player => {
                HOME_PATHS[player].forEach((pos, index) => {
                    const cell = document.createElement('div');
                    cell.className = `cell path-${player}`;
                    cell.style.gridRow = pos.row + 1;
                    cell.style.gridColumn = pos.col + 1;
                    cell.dataset.homePath = `${player}-${index}`;
                    board.appendChild(cell);
                });
            });
        }

        // Initialize tokens
        function initializeTokens() {
            tokens = {};
            PLAYERS.forEach(player => {
                tokens[player] = [];
                for (let i = 0; i < 4; i++) {
                    tokens[player].push({
                        id: i,
                        position: -1, // -1 means in home base
                        state: 'home', // home, path, homeStretch, finished
                        homeStretchPosition: -1
                    });
                }
            });
            renderTokens();
        }

        // Render all tokens on the board
        function renderTokens() {
            // Remove existing tokens
            document.querySelectorAll('.token').forEach(t => t.remove());
            
            PLAYERS.forEach(player => {
                tokens[player].forEach(token => {
                    renderToken(player, token);
                });
            });
        }

        // Render a single token
        function renderToken(player, token) {
            const board = document.getElementById('board');
            
            if (token.state === 'home') {
                const homeSpot = document.querySelector(`[data-home-spot="${player}-${token.id}"]`);
                if (homeSpot) {
                    const tokenEl = createTokenElement(player, token);
                    homeSpot.appendChild(tokenEl);
                }
            } else if (token.state === 'path') {
                const cell = document.querySelector(`[data-path-index="${token.position}"]`);
                if (cell) {
                    const tokenEl = createTokenElement(player, token);
                    if (!cell.querySelector('.tokens-in-cell')) {
                        const container = document.createElement('div');
                        container.className = 'tokens-in-cell';
                        cell.appendChild(container);
                    }
                    cell.querySelector('.tokens-in-cell').appendChild(tokenEl);
                }
            } else if (token.state === 'homeStretch') {
                const cell = document.querySelector(`[data-home-path="${player}-${token.homeStretchPosition}"]`);
                if (cell) {
                    const tokenEl = createTokenElement(player, token);
                    cell.appendChild(tokenEl);
                }
            } else if (token.state === 'finished') {
                const centerHome = document.querySelector('.center-home');
                if (centerHome && !centerHome.querySelector(`.token.${player}`)) {
                    const tokenEl = createTokenElement(player, token);
                    tokenEl.style.width = '20px';
                    tokenEl.style.height = '20px';
                    centerHome.appendChild(tokenEl);
                }
            }
        }

        // Create token element
        function createTokenElement(player, token) {
            const tokenEl = document.createElement('div');
            tokenEl.className = `token ${player}`;
            tokenEl.dataset.player = player;
            tokenEl.dataset.tokenId = token.id;
            
            if (canMoveToken(player, token)) {
                tokenEl.classList.add('movable');
                tokenEl.addEventListener('click', () => moveToken(player, token.id));
            }
            
            return tokenEl;
        }

        // Check if a token can move
        function canMoveToken(player, token) {
            if (player !== PLAYERS[currentPlayer] || !hasRolled) return false;
            
            if (token.state === 'finished') return false;
            
            if (token.state === 'home') {
                return diceValue === 6;
            }
            
            // Check if move would exceed home
            if (token.state === 'path') {
                const distanceToHome = getDistanceToHome(player, token.position);
                if (diceValue <= distanceToHome) return true;
                if (diceValue > distanceToHome && diceValue <= distanceToHome + 6) return true;
                return false;
            }
            
            if (token.state === 'homeStretch') {
                return token.homeStretchPosition + diceValue <= 5;
            }
            
            return false;
        }

        // Get distance to home entry
        function getDistanceToHome(player, position) {
            const entry = HOME_ENTRY[player];
            if (position < entry) {
                return entry - position;
            } else {
                return 52 - position + entry;
            }
        }

        // Move token
        function moveToken(player, tokenId) {
            if (!canMoveToken(player, tokens[player][tokenId])) return;
            
            const token = tokens[player][tokenId];
            
            if (token.state === 'home') {
                // Move out of home
                token.state = 'path';
                token.position = START_POSITIONS[player];
            } else if (token.state === 'path') {
                const distanceToHome = getDistanceToHome(player, token.position);
                
                if (diceValue > distanceToHome) {
                    // Enter home stretch
                    token.state = 'homeStretch';
                    token.homeStretchPosition = diceValue - distanceToHome - 1;
                } else {
                    // Move on path
                    token.position = (token.position + diceValue) % 52;
                }
            } else if (token.state === 'homeStretch') {
                token.homeStretchPosition += diceValue;
                
                if (token.homeStretchPosition === 5) {
                    token.state = 'finished';
                }
            }
            
            // Check for captures
            if (token.state === 'path' && !SAFE_ZONES.includes(token.position)) {
                checkCapture(player, token.position);
            }
            
            renderTokens();
            
            // Check for winner
            if (checkWinner(player)) {
                showWinner(player);
                return;
            }
            
            // If rolled 6, get another turn
            if (diceValue === 6) {
                hasRolled = false;
                document.getElementById('rollBtn').disabled = false;
                document.getElementById('message').textContent = `${player.charAt(0).toUpperCase() + player.slice(1)} rolled a 6! Roll again!`;
            } else {
                nextTurn();
            }
        }

        // Check for token captures
        function checkCapture(player, position) {
            PLAYERS.forEach(otherPlayer => {
                if (otherPlayer !== player) {
                    tokens[otherPlayer].forEach(token => {
                        if (token.state === 'path' && token.position === position) {
                            // Capture! Send token back home
                            token.state = 'home';
                            token.position = -1;
                            document.getElementById('message').textContent = `${player.charAt(0).toUpperCase() + player.slice(1)} captured ${otherPlayer}'s token!`;
                        }
                    });
                }
            });
        }

        // Check if player has won
        function checkWinner(player) {
            return tokens[player].every(token => token.state === 'finished');
        }

        // Show winner modal
        function showWinner(player) {
            const modal = document.getElementById('winnerModal');
            const winnerText = document.getElementById('winnerText');
            winnerText.textContent = `ðŸŽ‰ ${player.charAt(0).toUpperCase() + player.slice(1)} Wins! ðŸŽ‰`;
            modal.style.display = 'flex';
        }

        // Next turn
        function nextTurn() {
            currentPlayer = (currentPlayer + 1) % 4;
            hasRolled = false;
            diceValue = 0;
            consecutiveSixes = 0;
            document.getElementById('dice').textContent = 'ðŸŽ²';
            document.getElementById('rollBtn').disabled = false;
            updatePlayerInfo();
            document.getElementById('message').textContent = `${PLAYERS[currentPlayer].charAt(0).toUpperCase() + PLAYERS[currentPlayer].slice(1)}'s turn! Roll the dice.`;
            renderTokens();
        }

        // Update player info display
        function updatePlayerInfo() {
            PLAYERS.forEach((player, index) => {
                const playerInfo = document.getElementById(`player-${player}`);
                if (index === currentPlayer) {
                    playerInfo.classList.add('active');
                } else {
                    playerInfo.classList.remove('active');
                }
            });
        }

        // Roll dice
        function rollDice() {
            if (hasRolled) return;
            
            const dice = document.getElementById('dice');
            const rollBtn = document.getElementById('rollBtn');
            
            dice.classList.add('rolling');
            rollBtn.disabled = true;
            
            // Animate dice roll
            let rolls = 0;
            const rollInterval = setInterval(() => {
                dice.textContent = ['âš€', 'âš', 'âš‚', 'âšƒ', 'âš„', 'âš…'][Math.floor(Math.random() * 6)];
                rolls++;
                
                if (rolls >= 10) {
                    clearInterval(rollInterval);
                    diceValue = Math.floor(Math.random() * 6) + 1;
                    dice.textContent = ['âš€', 'âš', 'âš‚', 'âšƒ', 'âš„', 'âš…'][diceValue - 1];
                    dice.classList.remove('rolling');
                    hasRolled = true;
                    
                    // Check if any tokens can move
                    const player = PLAYERS[currentPlayer];
                    const canMove = tokens[player].some(token => canMoveToken(player, token));
                    
                    if (!canMove) {
                        document.getElementById('message').textContent = `${player.charAt(0).toUpperCase() + player.slice(1)} rolled ${diceValue} but has no valid moves!`;
                        setTimeout(nextTurn, 1500);
                    } else {
                        document.getElementById('message').textContent = `${player.charAt(0).toUpperCase() + player.slice(1)} rolled ${diceValue}! Select a token to move.`;
                        renderTokens();
                    }
                }
            }, 100);
        }

        // Restart game
        function restartGame() {
            document.getElementById('winnerModal').style.display = 'none';
            currentPlayer = 0;
            diceValue = 0;
            hasRolled = false;
            consecutiveSixes = 0;
            document.getElementById('dice').textContent = 'ðŸŽ²';
            document.getElementById('rollBtn').disabled = false;
            document.getElementById('message').textContent = "Red's turn! Roll the dice to start.";
            initGame();
        }

        // Event listeners
        document.getElementById('rollBtn').addEventListener('click', rollDice);
        document.getElementById('dice').addEventListener('click', rollDice);

        // Initialize game on load
        initGame();
    </script>
</body>
</html>
